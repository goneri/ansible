# Test code for the vmware_host_dns module.
# Copyright: (c) 2019, Mario Lenz <m@riolenz.de>
# GNU General Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)

- import_role:
    name: prepare_vmware_tests
  vars:
    setup_attach_host: true

- name: Gather DNS facts about ESXi Host
  vmware_host_dns_info:
    hostname: '{{ esxi1 }}'
    username: '{{ esxi_user }}'
    password: '{{ esxi_password }}'
    esxi_hostname: "{{ esxi1 }}"
    validate_certs: False
  register: res

- include_tasks: dhcp.yml
  when: res['hosts_dns_facts']['{{ esxi1 }}']['dhcp']
- include_tasks: static.yml
  when: not res['hosts_dns_facts']['{{ esxi1 }}']['dhcp']
